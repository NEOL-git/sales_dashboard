# 📁 Excel/CSV 파일 업로드 가이드

## 🎯 개요

Streamlit 대시보드에 **Excel 및 CSV 파일 업로드 기능**이 추가되었습니다! 이제 자신의 판매 데이터를 직접 업로드하여 실시간으로 분석할 수 있습니다.

### ⭐ 지원 형식
- **Excel**: `.xlsx`, `.xls`
- **CSV**: `.csv` (UTF-8, CP949, EUC-KR 등 자동 인코딩 감지)

---

## 🚀 빠른 시작

### 1단계: 대시보드 실행
```bash
streamlit run app.py
```

### 2단계: 파일 업로드
1. 브라우저에서 대시보드 열기 (`http://localhost:8501`)
2. **왼쪽 사이드바** 상단의 **"📁 데이터 소스"** 섹션 찾기
3. **"Browse files"** 버튼 클릭
4. 파일 선택
   - **Excel**: `.xlsx` 또는 `.xls` (시트명 입력 필요)
   - **CSV**: `.csv` (시트명 불필요, 자동 처리)
5. 업로드 완료 후 자동 분석 시작!

---

## 📋 파일 형식 요구사항

### ✅ 필수 컬럼

Excel 파일에는 다음 컬럼들이 **반드시** 포함되어야 합니다:

| 컬럼명 | 데이터 타입 | 예시 | 설명 |
|--------|-------------|------|------|
| `날짜` | Date | 2019-01-15 | 거래 날짜 |
| `거래처명` | Text | (주)ABC | 거래처 이름 |
| `분류명` | Text | 컴퓨터 | 제품 분류 |
| `제품명` | Text | 노트북 | 제품 이름 |
| `단가` | Number | 1500000 | 제품 단가 (원) |
| `수량` | Number | 2 | 판매 수량 |
| `금액` | Number | 3000000 | 총 금액 (원) |

### 📋 선택 컬럼 (있으면 더 상세한 분석 가능)

| 컬럼명 | 데이터 타입 | 예시 | 설명 |
|--------|-------------|------|------|
| `Discount` | Number | 0.1 | 할인율 (0~1 소수) |
| `색상` | Text | 검정 | 제품 색상 |
| `제품코드` | Text | NB-001 | 제품 코드 |

---

## 📝 샘플 데이터 예시

### Excel 파일 구조 예시:

| 날짜 | 거래처명 | 분류명 | 제품명 | 단가 | 수량 | 금액 | Discount |
|------|---------|--------|--------|------|------|------|----------|
| 2019-01-15 | (주)ABC | 컴퓨터 | 노트북 | 1500000 | 2 | 3000000 | 0.1 |
| 2019-01-16 | (주)XYZ | 휴대폰 | 스마트폰 | 900000 | 3 | 2700000 | 0 |
| 2019-01-17 | (주)DEF | TV & 비디오 | 4K TV | 2000000 | 1 | 2000000 | 0.05 |

---

## 🎨 UI 사용법

### 사이드바 구조:

```
📁 데이터 소스
├─ Excel 파일 업로드 (선택사항)
│  └─ [Browse files] 버튼
│
├─ 시트명
│  └─ [Sheet1] (기본값)
│
└─ 상태 표시
   ├─ ✅ 업로드된 파일: 판매_2024.xlsx
   └─ ✅ 데이터 로드 완료: 1,802건
```

---

## 🔄 파일 변경하기

### 방법 1: 새 파일 업로드
1. 파일 업로더에서 **"×"** 버튼 클릭 (기존 파일 제거)
2. 새로운 파일 업로드

### 방법 2: 기본 파일로 돌아가기
1. 업로드된 파일 제거 (× 버튼)
2. 자동으로 기본 `판매.xlsx` 파일 사용

---

## ⚠️ 주의사항

### 파일 크기
- **권장**: 200MB 이하
- **최대**: Streamlit 기본 설정에 따름
- 대용량 파일은 로딩 시간이 길어질 수 있음

### 데이터 보안
- 업로드된 파일은 **메모리에만 임시 저장**
- 서버에 영구 저장되지 않음
- 브라우저를 닫으면 데이터 삭제됨

### 시트명
- 기본값: `Sheet1`
- Excel 파일의 정확한 시트명 입력 필요
- 대소문자 구분함

---

## 🐛 문제 해결

### ❌ "필수 컬럼 누락" 오류

**원인**: Excel 파일에 필수 컬럼이 없거나 이름이 다름

**해결책**:
1. Excel 파일 열기
2. 컬럼명 확인 및 수정:
   - `날짜`, `거래처명`, `분류명`, `제품명`, `단가`, `수량`, `금액`
3. 공백이나 특수문자 제거
4. 파일 저장 후 다시 업로드

### ❌ "파일 로드 중 오류" 발생

**원인**: 
- 파일이 손상됨
- Excel 형식이 아님
- 시트명이 잘못됨

**해결책**:
1. Excel에서 파일 열어서 확인
2. `.xlsx` 또는 `.xls` 형식으로 저장
3. 시트명 확인 (정확한 이름 입력)
4. 다른 Excel 파일로 테스트

### ❌ 파일 업로드가 느림

**원인**: 파일 크기가 큼

**해결책**:
1. 불필요한 시트 삭제
2. 데이터 행 수 줄이기
3. 파일 압축

### ❌ 날짜 형식 오류

**원인**: 날짜 컬럼이 텍스트 형식

**해결책**:
1. Excel에서 `날짜` 컬럼 선택
2. 셀 서식 → 날짜 형식 적용
3. 파일 저장 후 재업로드

### ❌ CSV 인코딩 오류

**원인**: CSV 파일의 인코딩을 인식할 수 없음

**해결책**:
1. **자동 감지**: 시스템이 UTF-8, CP949, EUC-KR, Latin1을 자동으로 시도
2. **수동 변환**: 
   - Excel에서 CSV 파일 열기
   - "다른 이름으로 저장" → CSV UTF-8 선택
   - 저장 후 재업로드
3. **온라인 도구**: 인코딩 변환 웹사이트 이용

### ❌ CSV 파일에서 한글이 깨짐

**원인**: 인코딩 불일치

**해결책**:
1. 메모장에서 CSV 파일 열기
2. "다른 이름으로 저장" → 인코딩을 "UTF-8" 선택
3. 저장 후 재업로드

---

## 💡 사용 팁

### 팁 1: 여러 파일 비교하기
1. 첫 번째 파일 업로드 → 분석 확인
2. 파일 제거 (×)
3. 두 번째 파일 업로드 → 비교

### 팁 2: 필터와 함께 사용
1. 파일 업로드
2. 날짜/제품 분류/거래처 필터 적용
3. 세밀한 분석 가능

### 팁 3: 차트 다운로드
1. 분석 결과 확인
2. 차트 우측 상단 카메라 아이콘 클릭
3. PNG 이미지로 저장

---

## 📊 샘플 데이터 다운로드

### 테스트용 샘플 파일 생성하기

#### 방법 1: Python으로 Excel 파일 생성

```python
import pandas as pd
from datetime import datetime, timedelta

# 샘플 데이터 생성
data = {
    '날짜': [datetime(2019, 1, 1) + timedelta(days=i) for i in range(10)],
    '거래처명': ['(주)ABC', '(주)XYZ', '(주)DEF', '(주)GHI', '(주)JKL'] * 2,
    '분류명': ['컴퓨터', '휴대폰', 'TV & 비디오', '오디오', '카메라'] * 2,
    '제품명': ['제품A', '제품B', '제품C', '제품D', '제품E'] * 2,
    '단가': [1000000, 800000, 1500000, 500000, 700000] * 2,
    '수량': [1, 2, 1, 3, 2] * 2,
    '금액': [1000000, 1600000, 1500000, 1500000, 1400000] * 2,
    'Discount': [0.1, 0, 0.05, 0.15, 0] * 2
}

df = pd.DataFrame(data)
df.to_excel('샘플_판매데이터.xlsx', sheet_name='Sheet1', index=False)
print("✅ 샘플 Excel 파일 생성 완료: 샘플_판매데이터.xlsx")
```

#### 방법 2: Python으로 CSV 파일 생성

```python
import pandas as pd
from datetime import datetime, timedelta

# 샘플 데이터 생성
data = {
    '날짜': [datetime(2019, 1, 1) + timedelta(days=i) for i in range(10)],
    '거래처명': ['(주)ABC', '(주)XYZ', '(주)DEF', '(주)GHI', '(주)JKL'] * 2,
    '분류명': ['컴퓨터', '휴대폰', 'TV & 비디오', '오디오', '카메라'] * 2,
    '제품명': ['제품A', '제품B', '제품C', '제품D', '제품E'] * 2,
    '단가': [1000000, 800000, 1500000, 500000, 700000] * 2,
    '수량': [1, 2, 1, 3, 2] * 2,
    '금액': [1000000, 1600000, 1500000, 1500000, 1400000] * 2,
    'Discount': [0.1, 0, 0.05, 0.15, 0] * 2
}

df = pd.DataFrame(data)
df.to_csv('샘플_판매데이터.csv', index=False, encoding='utf-8-sig')
print("✅ 샘플 CSV 파일 생성 완료: 샘플_판매데이터.csv")
```

**참고**: `encoding='utf-8-sig'`를 사용하면 Excel에서도 한글이 정상적으로 표시됩니다.

---

## 🔐 보안 및 프라이버시

### 데이터 처리 방식
- ✅ 로컬 메모리에서만 처리
- ✅ 서버에 저장 안 됨
- ✅ 세션 종료 시 자동 삭제
- ✅ 다른 사용자와 공유 안 됨

### 권장 사항
- 민감한 데이터는 테스트 후 삭제
- 로컬 네트워크에서만 사용 권장
- 공용 Wi-Fi에서 업로드 자제

---

## 📈 활용 사례

### 사례 1: 월별 판매 보고서
1. 각 월의 판매 데이터 Excel 파일 준비
2. 매월 파일 업로드하여 추이 분석
3. 차트 캡처하여 보고서에 첨부

### 사례 2: 거래처별 분석
1. 특정 거래처 데이터만 추출한 Excel 파일 생성
2. 업로드하여 집중 분석
3. 거래 패턴 및 트렌드 파악

### 사례 3: 제품 라인 비교
1. 제품 분류별 데이터 파일 준비
2. 각각 업로드하여 성과 비교
3. 전략 수립 자료로 활용

---

## 🆚 기본 파일 vs 업로드 파일

| 항목 | 기본 파일 (판매.xlsx) | 업로드 파일 |
|------|---------------------|------------|
| 위치 | 프로젝트 폴더 | 사용자 선택 |
| 로딩 | 자동 | 수동 업로드 |
| 형식 | Excel | Excel/CSV |
| 캐싱 | ✅ | ❌ |
| 변경 | 파일 수정 필요 | 언제든지 변경 |
| 속도 | 빠름 (캐싱) | 보통 |

---

## 📞 지원

### 문제가 계속될 때
1. 브라우저 캐시 삭제
2. Streamlit 재시작
3. Excel 파일 재저장
4. 데이터 분석팀에 문의

### 피드백
새로운 기능 요청이나 개선사항은 언제든지 제안해주세요!

---

**버전**: v2.2 (CSV 파일 지원 추가)  
**최종 수정일**: 2025년 10월 17일  
**작성자**: 데이터 분석팀

**주요 업데이트**:
- ✅ CSV 파일 업로드 지원
- ✅ 자동 인코딩 감지 (UTF-8, CP949, EUC-KR, Latin1)
- ✅ CSV 전용 UI 개선 (시트명 입력 불필요)

